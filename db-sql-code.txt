-- Generated by Oracle SQL Developer Data Modeler 19.4.0.350.1424

CREATE TABLE role (
    id_role       INTEGER NOT NULL,
    "Nazwa roli"  VARCHAR2(20 CHAR)
);

ALTER TABLE role ADD CONSTRAINT role_pk PRIMARY KEY ( id_role );

CREATE TABLE "user" (
    id_user             INTEGER NOT NULL,
    imię                VARCHAR2(20 CHAR),
    nazwisko            VARCHAR2(40 CHAR),
    stanowisko          VARCHAR2(20 CHAR),
    płeć                VARCHAR2(10 CHAR),
    email               VARCHAR2(30 CHAR),
    login               VARCHAR2(10 CHAR),
    hasło               VARCHAR2(25 CHAR),
    "Aktywność konta"   CHAR(1) DEFAULT '1',
    "Data rejestracji"  DATE
);

ALTER TABLE "user" ADD CONSTRAINT user_pk PRIMARY KEY ( id_user );

CREATE TABLE user_role (
    role_fk  INTEGER NOT NULL,
    user_fk  INTEGER NOT NULL
);

ALTER TABLE user_role
    ADD CONSTRAINT role_fk FOREIGN KEY ( role_fk )
        REFERENCES role ( id_role );

ALTER TABLE user_role
    ADD CONSTRAINT user_fk FOREIGN KEY ( user_fk )
        REFERENCES "user" ( id_user );

CREATE SEQUENCE user_id_user_seq START WITH 1 NOCACHE ORDER;

CREATE OR REPLACE TRIGGER user_id_user_trg BEFORE
    INSERT ON "user"
    FOR EACH ROW
    WHEN ( new.id_user IS NULL )
BEGIN
    :new.id_user := user_id_user_seq.nextval;
END;

